{{ define "main" }}

  <script>
  var banner = [
        '     _    _         _   _____                _                                  _   _ _____ _     _        _    _     ',
        '    / \\  | |__   __| | | ____|_ __ _ __ __ _| |__  _ __ ___   __ _ _ __   ___  | | | | ____| |   | |      / \\  | |    ',
        "   / _ \\ | '_ \\ / _` | |  _| | '__| '__/ _` | '_ \\| '_ ` _ \\ / _` | '_ \\ / _ \\ | |_| |  _| | |   | |     / _ \\ | |    ",
        '  / ___ \\| |_) | (_| | | |___| |  | | | (_| | | | | | | | | | (_| | | | |  __/ |  _  | |___| |___| |___ / ___ \\| |___ ',
        ' /_/   \\_\\_.__/ \\__,_| |_____|_|  |_|  \\__,_|_| |_|_| |_| |_|\\__,_|_| |_|\\___| |_| |_|_____|_____|_____/_/   \\_\\_____|'
    ];
  var help = [
        '[[b;#fff;]posts]   see all blog posts',
        
    ];  
  var term = $('body').terminal({
    help: function() {
       $.each( help, function( index ) {
       	term.echo(help[index])
       });
    },read: function(url) {
        var title;
        var content;
    		$.getJSON( "posts/index.json", function( data ) {
    		$.each( data, function( index ) {
    			var json_url = data[index]["post"][0] ;
					if(json_url == "https://www.elhellal.com"+url){
						title = data[index]["post"][1] ;
					  content = $.parseHTML(data[index]["post"][2].replaceAll('\n', '')) ;
					  content = content
					  content = content
					  content = content
					  $.each(content, function( index ) {
					  console.log($(this).text());
					  if($(this).not("#text")){
					  console.log(content[index])
						term.echo(content[index]);
						}
						});
					}
				});
    		});
        
        
    },
    posts: function() {

    {{ with .Site.GetPage "section" "posts" }}
        var img = $('<ul>{{- range .Pages -}}<li><a class="title" href="{{ .Params.externalLink | default .RelPermalink }}">{{ .Title }}</a></li>{{- end -}}</ul>');
        this.echo(img);
    {{ end }}
    $( ".title" ).click(function(event) {
			event.preventDefault();
			var a_link = $(this).attr( "href" );
			
			term.exec("read "+a_link, false);
		});
    }
}, {
    greetings: false,
    onInit() {
    	    var title = this.cols() > banner[1].length ? banner.join('\n') : 'Abd Errahmane HELLAL';
    	    title = title + '\n\n' + 'Available commands: [[b;#fff;]posts], [[b;#fff;]projects], [[b;#fff;]about], [[b;#fff;]contact].\nType [[b;#fff;]help] for more info.';
            this.echo(title)
            $('[data-index="0"]').css("text-align","center");
        }
});

 </script>
{{ end }}
