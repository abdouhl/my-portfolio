{{ define "main" }}

  <script>
  var banner = [
        '     _    _         _   _____                _                                  _   _ _____ _     _        _    _     ',
        '    / \\  | |__   __| | | ____|_ __ _ __ __ _| |__  _ __ ___   __ _ _ __   ___  | | | | ____| |   | |      / \\  | |    ',
        "   / _ \\ | '_ \\ / _` | |  _| | '__| '__/ _` | '_ \\| '_ ` _ \\ / _` | '_ \\ / _ \\ | |_| |  _| | |   | |     / _ \\ | |    ",
        '  / ___ \\| |_) | (_| | | |___| |  | | | (_| | | | | | | | | | (_| | | | |  __/ |  _  | |___| |___| |___ / ___ \\| |___ ',
        ' /_/   \\_\\_.__/ \\__,_| |_____|_|  |_|  \\__,_|_| |_|_| |_| |_|\\__,_|_| |_|\\___| |_| |_|_____|_____|_____/_/   \\_\\_____|'
    ];
  var help = [
        '[[b;#fff;]posts]   see all blog posts',
        
    ];  
    
  var term = $('body').terminal({
      projects: function() {

    {{ with .Site.GetPage "section" "projects" }}
        var projects = $('<div class="pure-g">{{- range .Pages -}}<div class="image-card pure-u-1 pure-u-md-1-2 pure-u-lg-1-3 pure-u-xxl-1-4" onclick="'+"window.location.href='{{ .Params.link }}';"+'">{{ $img_screen := .Resources.GetMatch "screen.png" }}<img src="{{ $img_screen.Permalink }}" alt="{{ .Title }} image" style="height:200px;margin-right:15px;float: left;" ><div><h3>{{ .Title }}</h3><p>{{ .Params.description }}</p><div><dl><dt>tools</dt>{{ range .Params.tools }}<dd>- {{.}}</dd> {{- end -}}</dl></div></div></div>{{- end -}}</div>');
/*
<div class="pure-g">
{{- range .Pages -}}
<div class=" pure-u-1-3">
{{ $img_screen := .Resources.GetMatch "screen.png" }}
<img src="{{ $img_screen.Permalink }}" alt="{{ .Title }} image" style="height:170px;margin-right:15px;" >
<div>
<p>{{ .Title }}</p>
<p>{{ .Content }}</p>
</div>
</div>
{{- end -}}



*/
        this.echo(projects);
    {{ end }}
    
    },help: function() {
       $.each( help, function( index ) {
       	term.echo(help[index])
       });
    },read: function(url) {
        var title;
        var content;
    		$.getJSON( url.split("/")[1]+"/index.json", function( data ) {
    		$.each( data, function( index ) {
    			var json_url = data[index]["post"][0] ;
					if(json_url == {{ if .Site.IsServer }}"http://localhost:1313"{{ else }}"https://www.elhellal.com"{{ end }}+url){
						title = data[index]["post"][1] ;
					  content = $.parseHTML(data[index]["post"][2].replaceAll('\n', '')) ;
					  content = content
					  content = content
					  content = content
					  $.each(content, function( index ) {
					  console.log($(this).text());
					  if($(this).not("#text")){
					  console.log(content[index])
						term.echo(content[index]);
						}
						});
					}
				});
    		});
        
        
    },
    posts: function() {

    {{ with .Site.GetPage "section" "posts" }}
        var posts = $('<ul>{{- range .Pages -}}<li><a class="title" href="{{ .Params.externalLink | default .RelPermalink }}">{{ .Title }}</a></li>{{- end -}}</ul>');
        this.echo(posts);
    {{ end }}
    $( ".title" ).click(function(event) {
			event.preventDefault();
			var a_link = $(this).attr( "href" );
			term.exec("read "+a_link, false);
		});
    }
}, {
    greetings: false,
    onInit() {
    	    var title = this.cols() > banner[1].length ? banner.join('\n') : 'Abd Errahmane HELLAL';
    	    title = title + '\n\n' + 'Available commands: [[b;#fff;]posts], [[b;#fff;]projects], [[b;#fff;]about], [[b;#fff;]contact].\nType [[b;#fff;]help] for more info.';
            this.echo(title)
            $('[data-index="0"]').css("text-align","center");
        }
});

 </script>
{{ end }}
